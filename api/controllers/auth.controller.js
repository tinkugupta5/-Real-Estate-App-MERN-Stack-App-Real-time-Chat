import bcrypt from 'bcrypt';
import prisma from '../lib/prisma.js';

export const register = async (req, res) => {
     
          // db operation 
          const { username, email, password } = req.body;
          try {
          console.log("register working")
          // Hash the password
          const hashedPassword = await bcrypt.hash(password, 10);
          console.log("hashpassword", hashedPassword);
          // Create a new user and save to DB
          const newUser = await prisma.user.create({
               data: {
                    username,
                    email,
                    password: hashedPassword,
               }
          })
          console.log(newUser);
          res.status(201).json({
               message: "User created successfully"
          })

     } catch (error) {
          console.log(error);

          res.status(500).json({
               message:'Failed to created user!'
          })

     }
}
export const login = async(req, res) => {

     const {username,password} = req.body;
     
     try {

     // check if the user exists
     const user = await prisma.user.findUnique({
          where:{username}
     })

     if(!user) return res.status(401).json({
          message:"Invalid Credentials!"
     })

     // check if the password is correct
     const isPasswordValid = await bcrypt.compare(password,user.password);

     if(!isPasswordValid) return res.status(401).json({
          message:"Invalid Credentials"
     });


     // genrate cookie token and send to the user

     res.setHeader("Set-Cookie","test=" + "myValue")

          
     } catch (error) {
          console.log(error)
          res.status(500).json({
               message:"Failed to login"
          })
          
     }

     
}
export const logout = (req, res) => {
     // db operation 
}



// https://youtu.be/eJ3YysWaP_A?t=2522


{/* <svg width="306" height="15" viewBox="0 0 306 15" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_993_291)">
<path d="M116.485 10.0279C115.584 12.4465 113.198 15 110.059 15L109.928 14.9461C108.752 14.9111 107.419 14.5255 106.353 13.7616C105.574 13.2025 104.936 12.4401 104.61 11.4629C104.407 10.7923 104.343 10.0849 104.428 9.38808C104.513 8.69124 104.745 8.02054 105.105 7.42049C105.6 6.64674 106.294 6.02627 107.114 5.62814C107.935 5.23002 108.849 5.06941 109.754 5.16358C109.847 5.16777 109.94 5.19078 110.025 5.23212C110.11 5.27344 110.186 5.33204 110.249 5.40371C110.308 5.47539 110.359 5.55909 110.389 5.64959C110.414 5.74062 110.427 5.83636 110.418 5.93158C110.418 6.02889 110.401 6.12567 110.359 6.21513C110.321 6.30406 110.262 6.38358 110.19 6.44741C110.118 6.51176 110.033 6.55885 109.94 6.58605C109.847 6.61325 109.75 6.62006 109.653 6.6054C109.09 6.52484 108.51 6.59075 107.977 6.79688C107.444 7.00301 106.971 7.34253 106.598 7.78355C106.226 8.2251 105.972 8.75454 105.858 9.32217C105.744 9.88979 105.773 10.4778 105.938 11.0319C106.514 12.8105 108.637 13.5111 109.928 13.5514C112.331 13.6324 114.399 11.5775 115.169 9.50893C115.389 8.9434 115.525 8.35014 115.575 7.74903C115.613 7.27086 115.597 6.78747 115.525 6.3093C115.36 5.22949 114.92 4.21352 114.239 3.36444C112.969 1.87552 110.93 1.2017 108.506 1.46432C105.676 1.77455 103.726 3.74844 102.791 4.69169C102.622 4.87218 102.44 5.07778 102.249 5.29908L101.835 5.7966C100.151 7.82489 97.621 10.8969 93.1283 8.91619C92.4979 8.58818 91.9691 8.09275 91.5968 7.48274C91.2965 6.99829 91.1061 6.45579 91.0384 5.89286H-19.4586C-19.6233 5.89286 -19.7669 5.82171 -19.8641 5.70924C-19.9492 5.61507 -20 5.49212 -20 5.35714C-20 5.06104 -19.7591 4.82143 -19.4586 4.82143H91.0807C91.2033 4.2198 91.4699 3.65583 91.8676 3.18499C92.4049 2.5525 93.1409 2.12769 93.9532 1.9833C94.3593 1.93987 94.7697 1.96969 95.1632 2.06857C95.4381 2.13815 95.7047 2.24174 95.9585 2.37828C96.5762 2.70944 97.0795 3.21952 97.4096 3.8426C97.4646 3.92526 97.5069 4.01943 97.528 4.11883L97.5365 4.22032C97.5407 4.28729 97.5365 4.35425 97.5238 4.41964C97.4984 4.51853 97.4561 4.61113 97.3968 4.69169C97.3334 4.77277 97.2572 4.83922 97.1727 4.88735L97.0499 4.93915C96.9949 4.95641 96.94 4.9674 96.885 4.97158C96.8214 4.97629 96.7538 4.97158 96.6903 4.95693L96.5931 4.9292C96.4999 4.89416 96.4111 4.83922 96.3435 4.76807C96.2969 4.72203 96.2589 4.66919 96.2249 4.61217L96.1784 4.51644C95.9881 4.14185 95.692 3.83371 95.3281 3.62968C94.9601 3.42565 94.5455 3.33618 94.1309 3.37124C93.6529 3.47325 93.2255 3.73693 92.9125 4.1183C92.5994 4.50021 92.426 4.97786 92.4176 5.47329C92.4387 5.90541 92.5656 6.32604 92.7856 6.69539C93.0056 7.06526 93.3187 7.37235 93.6867 7.58894C97.2234 9.18562 99.0975 6.91512 100.752 4.89416L100.841 4.78115C101.187 4.37413 101.492 4.00321 101.792 3.69455C102.765 2.71782 105.029 0.426902 108.354 0.0633073C111.248 -0.246926 113.722 0.588558 115.305 2.44839C115.918 3.20697 116.375 4.07593 116.663 5.00611C116.768 5.35505 116.853 5.71238 116.908 6.07544C117.115 7.40741 116.971 8.77181 116.485 10.0279Z" fill="#A9A9A9"/>
</g>
<g clip-path="url(#clip1_993_291)">
<path d="M149.344 12H148.688C148.453 10.6562 147.5 8.96875 145.688 7.60938C144.797 6.9375 143.891 6.5 143 6.3125V5.65625C144.766 5.23437 146.5 4.04688 147.609 2.4375C148.172 1.625 148.531 0.828125 148.688 0H149.344C149.609 1.57813 150.828 3.32812 152.484 4.5C153.297 5.07812 154.141 5.46875 155 5.65625V6.3125C153.266 6.67187 151.25 8.21875 150.25 9.79688C149.75 10.5938 149.453 11.3281 149.344 12Z" fill="black"/>
<path d="M133.115 8H132.896C132.818 7.55208 132.5 6.98958 131.896 6.53646C131.599 6.3125 131.297 6.16667 131 6.10417V5.88542C131.589 5.74479 132.167 5.34896 132.536 4.8125C132.724 4.54167 132.844 4.27604 132.896 4H133.115C133.203 4.52604 133.609 5.10938 134.161 5.5C134.432 5.69271 134.714 5.82292 135 5.88542V6.10417C134.422 6.22396 133.75 6.73958 133.417 7.26562C133.25 7.53125 133.151 7.77604 133.115 8Z" fill="black"/>
<path d="M165.115 8H164.896C164.818 7.55208 164.5 6.98958 163.896 6.53646C163.599 6.3125 163.297 6.16667 163 6.10417V5.88542C163.589 5.74479 164.167 5.34896 164.536 4.8125C164.724 4.54167 164.844 4.27604 164.896 4H165.115C165.203 4.52604 165.609 5.10938 166.161 5.5C166.432 5.69271 166.713 5.82292 167 5.88542V6.10417C166.422 6.22396 165.75 6.73958 165.417 7.26562C165.25 7.53125 165.151 7.77604 165.115 8Z" fill="black"/>
</g>
<g clip-path="url(#clip2_993_291)">
<path d="M182.466 10.3594C183.282 12.6167 185.441 15 188.283 15L188.401 14.9497C189.466 14.917 190.672 14.5571 191.637 13.8442C192.341 13.3223 192.92 12.6108 193.214 11.6987C193.398 11.0728 193.456 10.4126 193.379 9.76221C193.302 9.11182 193.092 8.48584 192.766 7.92579C192.318 7.20362 191.69 6.62452 190.948 6.25293C190.205 5.88135 189.378 5.73145 188.558 5.81934C188.474 5.82325 188.39 5.84473 188.313 5.88331C188.237 5.92188 188.168 5.97657 188.11 6.04346C188.057 6.11036 188.011 6.18848 187.984 6.27295C187.961 6.35791 187.949 6.44727 187.957 6.53614C187.957 6.62696 187.972 6.71729 188.011 6.80079C188.045 6.88379 188.099 6.95801 188.164 7.01758C188.229 7.07764 188.306 7.12159 188.39 7.14698C188.474 7.17237 188.562 7.17872 188.65 7.16504C189.159 7.08985 189.684 7.15137 190.166 7.34375C190.649 7.53614 191.078 7.85303 191.415 8.26465C191.752 8.67676 191.981 9.1709 192.085 9.70069C192.188 10.2305 192.161 10.7793 192.012 11.2964C191.491 12.9565 189.569 13.6104 188.401 13.648C186.226 13.7236 184.354 11.8057 183.657 9.875C183.458 9.34717 183.335 8.79346 183.289 8.23243C183.255 7.78614 183.27 7.33497 183.335 6.88868C183.485 5.88086 183.883 4.93262 184.499 4.14014C185.648 2.75049 187.494 2.12159 189.688 2.3667C192.25 2.65625 194.015 4.49854 194.861 5.37891C195.014 5.54737 195.179 5.73926 195.351 5.94581L195.726 6.41016C197.25 8.30323 199.54 11.1704 203.607 9.32178C204.177 9.01563 204.656 8.55323 204.993 7.98389C205.265 7.53174 205.437 7.0254 205.498 6.5H305.51C305.659 6.5 305.789 6.4336 305.877 6.32862C305.954 6.24073 306 6.12598 306 6C306 5.72364 305.782 5.5 305.51 5.5H205.46C205.349 4.93848 205.108 4.41211 204.748 3.97266C204.261 3.38233 203.595 2.98584 202.86 2.85108C202.492 2.81055 202.121 2.83838 201.765 2.93067C201.516 2.99561 201.275 3.09229 201.045 3.21973C200.486 3.52881 200.03 4.00489 199.732 4.58643C199.682 4.66358 199.643 4.75147 199.624 4.84424L199.617 4.93897C199.613 5.00147 199.617 5.06397 199.628 5.125C199.651 5.21729 199.689 5.30372 199.743 5.37891C199.8 5.45459 199.869 5.51661 199.946 5.56153L200.057 5.60987C200.107 5.62598 200.157 5.63624 200.206 5.64014C200.264 5.64454 200.325 5.64014 200.382 5.62647L200.471 5.60059C200.555 5.56788 200.635 5.51661 200.696 5.4502C200.739 5.40723 200.773 5.35791 200.804 5.30469L200.846 5.21534C201.018 4.86573 201.286 4.57813 201.615 4.3877C201.949 4.19727 202.324 4.11377 202.699 4.14649C203.132 4.2417 203.518 4.4878 203.802 4.84375C204.085 5.2002 204.242 5.646 204.25 6.1084C204.231 6.51172 204.116 6.9043 203.917 7.24903C203.718 7.59424 203.434 7.88086 203.101 8.08301C199.9 9.57325 198.204 7.45411 196.707 5.56788L196.626 5.46241C196.312 5.08252 196.036 4.73633 195.765 4.44825C194.884 3.53663 192.835 1.39844 189.826 1.05909C187.207 0.769536 184.967 1.54932 183.534 3.28516C182.979 3.99317 182.566 4.8042 182.305 5.67237C182.21 5.99805 182.133 6.33155 182.083 6.67041C181.896 7.91358 182.026 9.18702 182.466 10.3594Z" fill="#A9A9A9"/>
</g>
<defs>
<clipPath id="clip0_993_291">
<rect width="124" height="14" fill="white"/>
</clipPath>
<clipPath id="clip1_993_291">
<rect width="36" height="12" fill="white" transform="translate(131)"/>
</clipPath>
<clipPath id="clip2_993_291">
<rect width="124" height="14" fill="white" transform="translate(182 1)"/>
</clipPath>
</defs>
</svg> */}
